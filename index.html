<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion d'Inventaire Web</title>
    <style>
        body {
            <script>
            document.addEventListener("DOMContentLoaded", () => {
    // Les s√©lecteurs pour les √©l√©ments HTML
    const scanButton = document.getElementById("scanButton");
    const manualEntry = document.getElementById("manualEntry");
    const addButton = document.getElementById("addButton");
    const openManualEntryButton = document.getElementById("openManualEntryButton");
    const searchEntry = document.getElementById("searchEntry");
    const inventoryBody = document.getElementById("inventoryBody");
    const deleteButton = document.getElementById("deleteButton");

    const productName = document.getElementById("productName");
    const productBrand = document.getElementById("productBrand");
    const productCategory = document.getElementById("productCategory");
    const productQuantity = document.getElementById("productQuantity");
    const productImage = document.getElementById("productImage");

    // Fonction pour r√©cup√©rer les informations d'un produit depuis l'API OpenFoodFacts
    async function getProductInfo(barcode) {
        const apiUrl = `https://world.openfoodfacts.org/api/v0/product/${barcode}.json`;
        try {
            const response = await fetch(apiUrl);
            const data = await response.json();
            if (data.status === 1) {
                const product = data.product;
                return {
                    code: barcode,
                    nom: product.product_name || "Inconnu",
                    marque: product.brands || "Inconnu",
                    cat√©gorie: product.categories || "Inconnu",
                    quantit√©: product.quantity || "N/A",
                    image: product.image_url || null
                };
            }
        } catch (error) {
            console.error("Erreur lors de la r√©cup√©ration des donn√©es :", error);
        }
        return null;
    }

    // Fonction pour charger l'inventaire depuis le stockage local (simule le fichier CSV)
    function loadInventory() {
        const inventory = JSON.parse(localStorage.getItem("inventory")) || [];
        return inventory;
    }

    // Fonction pour sauvegarder l'inventaire dans le stockage local
    function saveInventory(inventory) {
        localStorage.setItem("inventory", JSON.stringify(inventory));
    }

    // Fonction pour mettre √† jour l'affichage de l'inventaire
    function refreshInventory(filterText = "") {
        const inventory = loadInventory();
        inventoryBody.innerHTML = ""; // Vide le tableau

        const filteredInventory = inventory.filter(product =>
            product.nom.toLowerCase().includes(filterText.toLowerCase()) ||
            product.marque.toLowerCase().includes(filterText.toLowerCase())
        );

        filteredInventory.forEach(product => {
            const row = document.createElement("tr");
            row.dataset.code = product.code;
            row.innerHTML = `
                <td>${product.code}</td>
                <td>${product.nom}</td>
                <td>${product.marque}</td>
                <td>${product.cat√©gorie}</td>
                <td>${product.quantit√©}</td>
                <td><input type="checkbox" class="delete-checkbox"></td>
            `;
            inventoryBody.appendChild(row);
        });
    }

    // Fonction pour mettre √† jour les informations du produit affich√©es
    function updateUI(productInfo) {
        productName.textContent = `Produit : ${productInfo.nom}`;
        productBrand.textContent = `Marque : ${productInfo.marque}`;
        productCategory.textContent = `Cat√©gorie : ${productInfo.cat√©gorie}`;
        productQuantity.textContent = `Quantit√© : ${productInfo.quantit√©}`;
        if (productInfo.image) {
            productImage.src = productInfo.image;
            productImage.style.display = "block";
        } else {
            productImage.style.display = "none";
        }
    }

    // Fonction pour ajouter un produit √† l'inventaire
    async function addProductByCode(barcode) {
        const productInfo = await getProductInfo(barcode);
        if (productInfo) {
            const inventory = loadInventory();
            inventory.push(productInfo);
            saveInventory(inventory);
            updateUI(productInfo);
            refreshInventory();
            alert("Produit ajout√© avec succ√®s !");
        } else {
            alert("Produit non trouv√© !");
        }
    }

    // G√®re le scan de code-barres (n√©cessite une biblioth√®que externe comme QuaggaJS)
    scanButton.addEventListener("click", () => {
        alert("Le scan de code-barres n√©cessite une biblioth√®que externe (ex: QuaggaJS) et un environnement s√©curis√© (HTTPS).");
        // Logique de scan ici, par exemple :
        // Quagga.init({ ... }, function(err) { ... });
    });

    // G√®re l'ajout manuel via le champ de texte
    addButton.addEventListener("click", () => {
        const barcode = manualEntry.value.trim();
        if (barcode) {
            addProductByCode(barcode);
            manualEntry.value = "";
        } else {
            alert("Veuillez entrer un code-barres.");
        }
    });

    // G√®re la recherche
    searchEntry.addEventListener("keyup", (event) => {
        refreshInventory(event.target.value);
    });

    // G√®re la suppression d'un produit
    deleteButton.addEventListener("click", () => {
        const checkboxes = document.querySelectorAll(".delete-checkbox:checked");
        if (checkboxes.length === 0) {
            alert("S√©lectionnez au moins un produit √† supprimer.");
            return;
        }

        const inventory = loadInventory();
        const updatedInventory = inventory.filter(product => {
            let keep = true;
            checkboxes.forEach(checkbox => {
                const row = checkbox.closest("tr");
                if (row.dataset.code === product.code) {
                    keep = false;
                }
            });
            return keep;
        });

        saveInventory(updatedInventory);
        refreshInventory();
        alert("Produit(s) supprim√©(s) avec succ√®s !");
    });
    
    // Fonction pour ouvrir une fen√™tre modale d'ajout manuel (simul√©e ici)
    openManualEntryButton.addEventListener("click", () => {
        const name = prompt("Nom du produit :");
        if (!name) return;
        const brand = prompt("Marque du produit :");
        if (!brand) return;
        const category = prompt("Cat√©gorie du produit :");
        if (!category) return;
        const quantity = prompt("Quantit√© du produit :");
        if (!quantity) return;

        // G√©n√©rer un code unique (similaire √† np.random.randint)
        const barcode = `manual-${Math.floor(Math.random() * 100000) + 100000}`;
        const productInfo = { code: barcode, nom: name, marque: brand, cat√©gorie: category, quantit√©: quantity, image: null };
        
        const inventory = loadInventory();
        inventory.push(productInfo);
        saveInventory(inventory);
        updateUI(productInfo);
        refreshInventory();
        alert("Produit ajout√© manuellement avec succ√®s !");
    });

    // Appel initial pour afficher l'inventaire au chargement de la page
    refreshInventory();
});
        </script>
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
        }
        .container {
            max-width: 800px;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .section {
            margin-bottom: 20px;
        }
        .section-header {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 10px;
            border-bottom: 2px solid #ddd;
            padding-bottom: 5px;
        }
        .buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 15px;
        }
        button {
            padding: 10px 15px;
            font-size: 1em;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background-color: #007BFF;
            color: white;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #0056b3;
        }
        input[type="text"] {
            width: calc(100% - 22px);
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        .product-info {
            text-align: center;
            margin-top: 20px;
        }
        #productImage {
            max-width: 150px;
            height: auto;
            margin-top: 10px;
            border-radius: 5px;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Gestion d'Inventaire Web</h1>

        <div class="section">
            <div class="section-header">Scanner un produit</div>
            <div class="buttons">
                <button id="scanButton">üì∑ Scanner</button>
            </div>
            <input type="text" id="manualEntry" placeholder="Entrer un code-barres manuellement">
            <button id="addButton">‚ûï Ajouter</button>
        </div>

        <div class="section product-info">
            <div class="section-header">Informations du produit</div>
            <p id="productName">Produit : </p>
            <p id="productBrand">Marque : </p>
            <p id="productCategory">Cat√©gorie : </p>
            <p id="productQuantity">Quantit√© : </p>
            <img id="productImage" src="" alt="Image du produit" style="display: none;">
        </div>
        
        <div class="section">
            <div class="section-header">Ajouter un produit manuellement</div>
            <button id="openManualEntryButton">‚ûï Ajouter manuellement</button>
        </div>

        <div class="section">
            <div class="section-header">Rechercher un produit</div>
            <input type="text" id="searchEntry" placeholder="Rechercher par nom ou marque">
        </div>

        <div class="section">
            <div class="section-header">Inventaire</div>
            <table id="inventoryTable">
                <thead>
                    <tr>
                        <th>Code</th>
                        <th>Nom</th>
                        <th>Marque</th>
                        <th>Cat√©gorie</th>
                        <th>Quantit√©</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="inventoryBody">
                    </tbody>
            </table>
            <button id="deleteButton">Supprimer le produit s√©lectionn√©</button>
        </div>

    </div>

    <script>
        // La logique JavaScript viendrait ici
        // Elle inclurait les fonctions pour scanner, ajouter, supprimer et rafra√Æchir la table.
        // Exemple de pseudo-code JavaScript :
        // const scanButton = document.getElementById('scanButton');
        // scanButton.addEventListener('click', () => {
        //   // Logique pour acc√©der √† la cam√©ra et d√©coder le code-barres
        //   // Puis appeler l'API OpenFoodFacts
        //   // Puis mettre √† jour le tableau
        // });
        // const searchEntry = document.getElementById('searchEntry');
        // searchEntry.addEventListener('keyup', (event) => {
        //   // Logique pour filtrer la table
        // });
    </script>

</body>
</html>
